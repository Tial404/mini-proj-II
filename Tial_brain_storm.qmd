---
title: "brainstorming"
format: pdf
editor_options: 
  chunk_output_type: console
---
```{r}
#load libraries for extracting inat data
library(tidyverse)
library(rinat)
library(readr)
library(dplyr)

inat_stolaf <- read_csv("~/mini-proj-II/inat_with_invasives.csv")
```


##What species are most frequently observed by students and faculty at St Olaf College?
```{r}
topten <- clean_inat_stolaf |>
  drop_na(species_guess) |>
  count(species_guess, sort = TRUE) |>
  slice(1:10)

print(topten)
```




##Common species

```{r}
top25 <- inat_stolaf |>
  drop_na(species_guess) |>
  count(species_guess, sort = TRUE) |>
  slice(1:25)

top25joined <- top25|>
  left_join(inat_stolaf, by = "species_guess") 

top25joined |>
  ggplot(aes(x = species_guess, fill = quality_grade)) +
  geom_bar(position = "stack") + 
  theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),  
        panel.grid.minor = element_line(color = "grey90")) + 
    labs(title = "Frequency of species observed and identified",
       subtitle = "Based on Quality Grade",
       x = "Species",
       y = "Number of observations") +
  scale_fill_viridis_d(option = "mako")
```

##When and where are these species being observed ?



----use this!!-----
```{r}
unique_coords <- unique(inat_stolaf[c("latitude", "longitude")])

library(leaflet)  

leaflet() |>
  addTiles() |>
  setView(lng = mean(unique_coords$longitude), 
          lat = mean(unique_coords$latitude), 
          zoom = 13) |> 
  addCircleMarkers(data = unique_coords,
    lat = ~latitude, 
    lng = ~longitude, 
    popup = "Observation Location",  
    radius = 2,
    weight = 2,
    color = "purple", 
    fillColor = "purple")

```


----not this---
```{r}
library(leaflet)

leaflet() |> 
  addTiles() |>
  setView(-93.18226, 44.45861, zoom = 17) |>
  addMarkers(lng = -93.18226, lat = 44.45861, popup = "Observation Location") 
```

##How many invasive species are identified at St Olaf College?


##How many native species are identified at St Olaf College?




