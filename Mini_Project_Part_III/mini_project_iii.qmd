---
title: "Mini Project III - Tial and Jessica"
format: pdf
editor_options: 
  chunk_output_type: console
---
```{r}
#load libraries for extracting inat data
library(tidyverse)
library(rinat)
```


```{r}
#extract raw data of all observations
raw_obs <- get_inat_obs_project("st-olaf-natural-lands", type = "observations")

#Created a new data frame called "obs_clean" from the previous data frame "raw_obs" which contains our raw data of observations. 
obs_clean <- raw_obs |>
  
#Using the select() function, we selected specific columns we want to include in our new data frame "obs_clean."
   select(observed_on, description, latitude, longitude, species_guess, user_id, created_at, updated_at,    place_guess, num_identification_agreements, num_identification_disagreements, quality_grade, uri, captive) |>
  
#We used the mutate() function to modify specific columns. 
#The ymd() function converts date columns to follow this format:  year-month-day 
#For the "created_at" and "updated_at" columns, we used the str_extract() function to isolate just the dates before reformatting it to years-month-day. 
#The parse_number() function extracts numeric values from "latitude" and "longitude" columns. 
#Finally, the replace_na() function for the "species_guess" column to replace any "NAs" with "unknown."
  
  mutate(observed_on = ymd(observed_on),
         latitude = parse_number(latitude), 
         longitude = parse_number(longitude),
         created_at = ymd(str_extract(created_at, "\\d{4}-\\d{2}-\\d{2}")),
         updated_at = ymd(str_extract(updated_at, "\\d{4}-\\d{2}-\\d{2}")),
         species_guess = replace_na(species_guess, "unknown"))|>
  
#Here, we used the rename() function to assign new names to specific columns. 
          rename (species = species_guess,
          location = place_guess, 
          quality = quality_grade,
          URL = uri,
          id_agreements = num_identification_agreements,
          id_disagreements = num_identification_disagreements) 
```

```{r}
write_csv(obs_clean, "TJ_mini3")
```

Variable Description Table : name, type, description of what it is 
|variable name | data type | description |
|-------------|-------------|---------------------------------------------|
|observed_on  |Date  |The day the uploaded made the observation   |
|description|Character | |
|latitude |Numeric | |
|longitude |Numeric | |
|species |Character |The species of  |
|user_id |Integer | |
|created_at |Date | |
|updated_at |Date |The date of when the uploader updated their post |
|location |Character | |
|id_agreements |Integer | |
|id_disagreements |Integer | |
|quality |Character | |
|URL |Character | |
|captive |Logical | |

