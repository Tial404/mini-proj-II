---
title: "Flexdashboard "
output: flexdashboard::flex_dashboard
runtime: shiny
---

```{r global, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(AER)
library(tidyverse)
library(rinat)

library(readr)
clean_inat_stolaf <- read_csv("~/mini-proj-II/clean_inat_stolaf.csv")
View(clean_inat_stolaf)
```

About
==========================

Column {data-width = 200}
-------------------------

**Background Information**


Column {data-width = 200}
-------------------------


Top 10 species frequently identified 
========================================
Inputs {.sidebar}
-------------------------

```{r}
topten <- clean_inat_stolaf |>
  drop_na(species_guess) |>
  count(species_guess, sort = TRUE) |>
  slice(1:10)

print(topten)
```

Column 
-------------------------

Column {data-width = 300} {data-length = 100}
-------------------------

Species observed:
========================================
Inputs {.sidebar}
-------------------------
```{r}
topfifty <- clean_inat_stolaf |>
  drop_na(species_guess) |>
  count(species_guess, sort = TRUE) |>
  slice(1:50)

print(topfifty)
```

```{r}
topfiftyjoined <- topfifty |>
  left_join(clean_inat_stolaf, by = "species_guess") 
  
  print(topfiftyjoined)
```

```{r}
topfiftyjoined |>
  ggplot(aes(x = species_guess, fill = quality_grade)) +
  geom_bar(position = "stack") + 
  theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1),  
        panel.grid.minor = element_line(color = "grey90")) + 
    labs(title = "Frequency of species observed and identified",
       subtitle = "Based on Quality Grade",
       x = "Species",
       y = "Number of observations") +
  scale_fill_viridis_d(option = "mako")
```

Column 
-------------------------
```{r, echo=FALSE, warning=FALSE}
renderPlot({
     if (input$type_check) 
        ggplot(penguins, aes(x = species, y = bill_len))  + 
          geom_jitter(aes(color = sex), size = 0.9, alpha = 0.9) +
          scale_color_manual(values=c("purple","blue"))  +
    theme_bw()
  
     else if (!input$type_check)      
        ggplot(penguins, aes(x = species, y = bill_len))  + 
          geom_jitter(size = 0.9, alpha = 0.9) +
          scale_color_manual(values=c("purple","blue"))  +
    theme_bw()
})
```
Column {data-width = 300} {data-length = 100}
-------------------------

Location 
==========================

Inputs {.sidebar}
-------------------------
```{r}
library(leaflet)

leaflet() |> 
  addTiles() |>
  setView(-93.1832, 44.4597, zoom = 17) |>   
  addPopups(-93.18226, 44.45861, 'Here is the 
Norway Valley Dr, Northfield, MN, US' )

```
